pipeline{
    agent any
    parameters {
        string (name: 'VERSION', defaultValue: '1.0.0')
    }

    stages{
        // stage("fetch code" ){

        // }
        stage("build"){
            steps{
                script{
                   // This step should not normally be used in your script. Consult the inline help for details.
                    withDockerRegistry(credentialsId: 'dockerhub_id') {
                        sh "docker build -t myapp:${params.VERSION} ."
                        sh "docker tag myapp:${params.VERSION} adelinau/myapp:${params.VERSION}"
                        sh "docker push adelinau/myapp:${params.VERSION}"
                    }
                }
            }
                
        }
    }
 }
    